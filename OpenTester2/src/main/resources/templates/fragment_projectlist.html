<div th:insert="~{fragment_projectheader}"></div>
<table class="table table-striped">
	<thead>
    	<tr>
			<th></th>
			<th th:text="#{label.project.id}">ID</th>
			<th th:text="#{label.project.projectname}">Project</th>
			<th th:text="#{label.project.projectype}">Type</th>
			<th th:text="#{label.project.status}">Status</th>
			<th th:text="#{label.project.location}">Location</th>
<!--			<th th:text="#{label.project.startduedate}">Start Due Date</th>
			<th th:text="#{label.project.startdate}">Start Date</th> -->
			<th th:text="#{label.project.completeduedate}">Complete Due Date</th>
			<th th:text="#{label.project.completedate}">Complete Date</th>
			<th th:text="#{label.project.operator}">Complete Date</th>
			<th>Progress</th>
			<th>control</th>
		</tr>
	</thead>
	<tbody>
		<tr th:each="item : ${list}">
			<td th:text="${item.id}"></td>
			<td>
				<button class="btn btn-secondary edit" th:onclick="|fragment_projectlist_detail('__${item.id}__')|" th:text="#{button.table.detail}">Edit</button>
			</td>
			<td th:text="${item.name}"></td>
			<td th:text="${item.type}"></td>
			<td th:text="${item.status}"></td>
			<td th:text="${item.location}"></td>
<!--			<td th:text="${item.startDueDate}"></td> 
			<td th:text="${item.startDate}"></td> -->
			<td th:text="${item.completeDueDate}"></td> 
			<td th:text="${item.completeDate}"></td> 
			<td th:text="${item.operator}"></td> 
			<td>
				<canvas class="progressbar" th:id="|progress_${item.id}|"></canvas>
			</td>
			<td>
				<button class="btn btn-secondary edit" th:onclick="|fragment_projectlist_edit('__${item.id}__')|" th:text="#{button.table.edit}">Edit</button>				
				<button class="btn btn-secondary copy" th:onclick="|fragment_projectlist_copy('__${item.id}__')|" th:text="#{button.table.copy}">Copy</button>
				<button class="btn btn-secondary del" th:onclick="|fragment_projectlist_delete('__${item.id}__')|" th:text="#{button.table.delete}">Delete</button>
			</td>
		</tr>
	</tbody>
</table>
<button class="btn btn-primary" id="new_project" th:text="#{label.project.createnew}" onclick="fragment_projectlist_create()"></button>

<script type="text/javascript" th:inline="javascript">
	$(function() {
		var list = /*[[${list}]]*/;
		for (var i = 0; i < list.length; i++) {
			var p = list[i];
        	new ProgressBar('progress_' + p.id, p.passed, p.failed, p.untouched);
        }
	});

	function fragment_projectlist_detail(id) {
		pageController.mainPage('/admin/fragment_dutpackagelist?projectid=' + id);
	}
	function fragment_projectlist_edit(id) {
		$.ajax({
		  url: '/admin/fragment_project_dialog?id=' + id,
		  type: 'GET',
		  dataType: "text", 
		}).done((data, textStatus, jqXHR) => {
			largeDialog.showDialog(data);
		}).fail((jqXHR, textStatus, errorThrown) => {
		    
		});			
	}	
	function fragment_projectlist_delete(id) {
		$.ajax({
		  url: '/api/project/admin/project/' + id,
		  type: 'DELETE',
		  dataType: "text", 
		}).done((data, textStatus, jqXHR) => {

		}).fail((jqXHR, textStatus, errorThrown) => {
		    
		});			
	}
	
	function fragment_projectlist_create() {
		$.ajax({
		  url: '/api/project/admin/project/',
		  type: 'PUT',
		  dataType: "text", 
		}).done((data, textStatus, jqXHR) => {

		}).fail((jqXHR, textStatus, errorThrown) => {
		    
		});				
	}
</script>
<table class="table table-striped">
	<thead>
    	<tr>
			<th th:text="#{label.project.projectname}">Project</th>
			<th th:text="#{label.project.projectype}">Type</th>
			<th th:text="#{label.project.status}">Status</th>
			<th th:text="#{label.project.location}">Location</th>
			<th th:text="#{label.project.startduedate}">Start Due Date</th>
			<th th:text="#{label.project.startdate}">Start Date</th>
			<th th:text="#{label.project.completdueedate}">Complete Due Date</th>
			<th th:text="#{label.project.completdueedate}">Complete Date</th>
			<th>Progress</th>
			<th>control</th>
		</tr>
	</thead>
	<tbody>
		<tr th:each="project : ${projectlist}">
			<td th:text="${project.projectName}"></td>
			<td th:text="${project.type}"><div id="progress_0"></div></td>
			<td th:text="${project.status}"></td>
			<td th:text="${project.location}"></td>
			<td th:text="${project.startDueDate}"></td> 
			<td th:text="${project.startDate}"></td> 
			<td th:text="${project.completeDueDate}"></td> 
			<td th:text="${project.completeDate}"></td> 
			<td>
				<canvas th:id="|progress_${project.id}|"></canvas>
			</td>
			<td>
				<button class="btn btn-secondary edit" data-bs-toggle="modal" th:onclick="|fragment_projectlist_edit('__${inst.id}__')|" th:text="#{button.table.edit}">Edit</button>
				<button class="btn btn-secondary copy" data-bs-toggle="modal" th:onclick="|fragment_projectlist_copy('__${inst.id}__')|" th:text="#{button.table.copy}">Copy</button>
				<button class="btn btn-secondary del" th:onclick="|fragment_projectlist_delete('__${inst.id}__')|" th:text="#{button.table.delete}">Delete</button>
			</td>
		</tr>
	</tbody>
</table>
<script type="text/javascript" th:inline="javascript">
	$(function() {
		debugger;
		var projects = /*[[${projectlist}]]*/;
		for (var i = 0; i < projects.length; i++) {
			var p = projects[i];

//			var p = new Object();
//			p.id = 0;
//			p.passed = 10;
//			p.failed = 20;
//			p.untouched = 20;
        	showBar('progress_' + p.id, p.passed, p.failed, p.untouched);
        }
	});
	function showBar(div, passed, failed, untouched) {
		debugger;
		// 横軸のラベル
		var xlabels           = ["Progress"];
		
		// １つ目の系列の情報を設定
		var series01name      = "Pass";                          // 系列１の名前
		var series01data      = [ passed]; // 系列１データ
		var series01bgcolor   = "rgba(0, 255, 0, 0.5)";           // 系列１の塗りつぶし色
		var series01linecolor = "rgba(0, 255, 0, 1.0)";           // 系列１の線の色
		// ２つ目の系列の情報を設定
		var series02name      = "Fail";
		var series02data      = [ failed];
		var series02bgcolor   = "rgba(255, 0, 0, 0.5)";
		var series02linecolor = "rgba(255, 0, 0, 1.0)";
		
		var series03name      = "Untouched";
		var series03data      = [ untouched];
		var series03bgcolor   = "rgba(50, 50, 50, 0.5)";
		var series03linecolor = "rgba(50, 50, 50, 1.0)";
		// ３つ以上系列を描画する場合は上のセットを追加する
		
		// グラフ縦軸の最大／最小／目盛りの間隔を設定
		var ymax  = passed + failed + untouched;  // グラフ縦軸の最大
		var ymin  =  0;  // グラフ縦軸の最小
		var ystep = ymax / 10;  // グラフ縦軸の目盛り線を引く間隔
		
		var ctx = document.getElementById(div).getContext("2d");
		var myChart1 = new Chart(ctx, {
		  type: "bar",
		  data: {
		    labels: xlabels,
		    datasets:[
		      {
		        label:           series01name,
		        data:            series01data,
		        backgroundColor: series01bgcolor,
		        borderColor:     series01linecolor,
		        borderWidth:     1,
		      }, 
		      {
		        label:           series02name,
		        data:            series02data,
		        backgroundColor: series02bgcolor,
		        borderColor:     series02linecolor,
		        borderWidth:     1,
		      },
		      {
		        label:           series03name,
		        data:            series03data,
		        backgroundColor: series03bgcolor,
		        borderColor:     series03linecolor,
		        borderWidth:     1,
		      }
		      // ３つ以上系列を描画する場合は上のセットを追加する
		    ]
		  },
		  options: {
			indexAxis: 'y',
		    scales: {
			  x: {
				stacked: true,  
			  },
		      y: {
//		        display:      true,
		        stacked: true,
//		        suggestedMax: ymax,
//		        suggestedMin: ymin,
//		        ticks: {
//		          stepSize: ystep,
//		        },
		      }
		    }
		  },
		  plugins: [ChartDataLabels]
		});

	};
			

</script>
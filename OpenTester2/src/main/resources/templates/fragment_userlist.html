<div>
	<div id="fragment_userlist_tableid"></div>
<!--
	<div id="fragment_userlist_usertable" th:insert="~{fragment_usertable}"></div> 
-->
	<div id="fragment_userlist_message"></div>
	<div class="modal" id="fragment_userlist_staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="fragment_userlist_staticBackdropLabel" aria-hidden="true">
	  <div class="modal-dialog">
	    <div class="modal-content">
	      <div class="modal-header">
	        <h5 class="modal-title" id="fragment_userlist_staticBackdropLabel" th:text="#{title.form.userinfo}">Modal title</h5>
	        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
	      </div>
	      <div class="modal-body">
			  <div id="fragment_userlist_dialogbody"></div>
	      </div>
	      <div class="modal-footer">
	        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" th:text="#{button.dialog.cancel}">Cancel</button>
	        <button id="update_ok" type="button" class="btn btn-primary" th:onclick="fragment_userlist_update_ok();" th:text="#{button.dialog.ok}">OK</button>
	        <button id="new_ok" type="button" class="btn btn-primary" th:onclick="fragment_userlist_new_ok();" th:text="#{button.dialog.ok}">OK</button>
	      </div>
	    </div>
	  </div>
	</div>
	<button onclick="fragment_userlist_onClickNewUser();" th:text="#{label.user.newuser}"></button>
<!--	<div th:insert="~{fragment_newuser}"></div>  -->
</div>
<script type="text/javascript" th:inline="javascript">		
	$(function() {
		fragment_newuser_getlist();
	});
	
	function fragment_userlist_onClickNewUser() {
		$('#update_ok').hide();
		$('#new_ok').show();
		
		$.ajax({
		  url: '/admin/fragment_newuserinfo',
		  type: 'GET',
		  dataType: "text",
		}).done((data, textStatus, jqXHR) => {
			$('#fragment_userlist_dialogbody').empty();
			$('#fragment_userlist_dialogbody').append(data);
			$('#fragment_userlist_staticBackdrop').modal('show');
		}).fail((jqXHR, textStatus, errorThrown) => {
			//fragment_userinfo_showMessage(jqXHR.responseText);
		});				
		
	}
	
	function fragment_newuser_getlist() {
		$.ajax({
		  url: '/admin/fragment_usertable',
		  type: 'GET',
		  dataType: "text",
		}).done((data, textStatus, jqXHR) => {
			$('#fragment_userlist_tableid').empty();
			$('#fragment_userlist_tableid').append(data);
		}).fail((jqXHR, textStatus, errorThrown) => {
			//fragment_userinfo_showMessage(jqXHR.responseText);
		});			
	}

	function fragment_userlist_update_ok() {
	debugger;
		var user = fragment_userinfo_object();
		$.ajax({
			url: '/api/admin/user',
			type: 'POST',
			data: JSON.stringify(user),
			contentType: 'application/json',
			dataType: 'json'
		}).done((data, textStatus, jqXHR) => {
			$('#fragment_userlist_staticBackdrop').modal('hide');
			fragment_newuser_getlist();
		}).fail((jqXHR, textStatus, errorThrown) => {
			fragment_userinfo_showMessage(jqXHR.responseText);
		});				
	}
	function fragment_userlist_new_ok() {
		var user = fragment_userinfo_object();
		$.ajax({
			url: '/api/admin/newuser',
			type: 'POST',
			data: JSON.stringify(user),
			contentType: 'application/json',
			dataType: 'json'
		}).done((data, textStatus, jqXHR) => {
			$('#fragment_userlist_staticBackdrop').modal('hide');
			fragment_newuser_getlist();
		}).fail((jqXHR, textStatus, errorThrown) => {
			fragment_userinfo_showMessage(jqXHR.responseText);
			console.log(textStatus);
		});				
	}
		
	function fragment_usertable_onEdit(username) {
		$('#update_ok').show();
		$('#new_ok').hide();
		$('#fragment_userlist_dialogbody').empty();
		$.ajax({
		  url: '/admin/fragment_userinfo?username=' + username,
		  type: 'GET',
		  dataType: "text",
		}).done((data, textStatus, jqXHR) => {
			debugger;
			$('#fragment_userlist_dialogbody').append(data);
			$('#fragment_userlist_staticBackdrop').modal('show');
		}).fail((jqXHR, textStatus, errorThrown) => {
			//fragment_userinfo_showMessage(jqXHR.responseText);
		});	
	}
	
	function fragment_usertable_onDelete(username) {
		$('#fragment_userlist_message').removeClass('alert alert-danger');
		$('.modal-body').empty();
		$.ajax({
		  url: '/api/admin/user?username=' + username,
		  type: 'DELETE',
		  dataType: "json",
		}).done((data, textStatus, jqXHR) => {
			//$('.modal-body').append(data);
			fragment_newuser_getlist();
		}).fail((jqXHR, textStatus, errorThrown) => {
			$('#fragment_userlist_message').empty();
			$('#fragment_userlist_message').addClass('alert alert-danger');
			$('#fragment_userlist_message').append('<label>' + jqXHR.responseText + '</label>');
		});				
	}
	
	
/*	function fragment_userlist_updateTable() {
		$('#fragment_userlist_usertable').empty();
		$.ajax({
		  url: '/admin/fragment_usertable',
		  type: 'GET',
		  dataType: "text",
		}).done((data, textStatus, jqXHR) => {
			$('#fragment_userlist_usertable').append(data);
		}).fail((jqXHR, textStatus, errorThrown) => {
			console.log(textStatus);
		});	
	}
*/
</script>
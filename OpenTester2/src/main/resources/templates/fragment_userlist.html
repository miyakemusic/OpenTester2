<div>
	<div id="fragment_userlist_usertable" th:insert="~{fragment_usertable}"></div> 
	<div id="fragment_userlist_message"></div>
	<!-- Modal -->
	<div class="modal" id="fragment_userlist_staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="fragment_userlist_staticBackdropLabel" aria-hidden="true">
	  <div class="modal-dialog">
	    <div class="modal-content">
	      <div class="modal-header">
	        <h5 class="modal-title" id="fragment_userlist_staticBackdropLabel" th:text="#{title.form.userinfo}">Modal title</h5>
	        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
	      </div>
	      <div class="modal-body">
	      </div>
	      <div class="modal-footer">
	        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" th:text="#{button.dialog.cancel}">Cancel</button>
	        <button type="button" class="btn btn-primary" th:onclick="fragment_userlist_onOk();" th:text="#{button.dialog.ok}">OK</button>
	      </div>
	    </div>
	  </div>
	</div>
	<script type="text/javascript" th:inline="javascript">	
		function fragment_userlist_onOk() {
			var user = fragment_userinfo_object();
			$.ajax({
				url: '/api/admin/user',
				type: 'POST',
				data: JSON.stringify(user),
				contentType: 'application/json',
				dataType: 'json'
			}).done((data, textStatus, jqXHR) => {
				$('#fragment_userlist_staticBackdrop').modal('hide');
				fragment_userlist_updateTable();
			}).fail((jqXHR, textStatus, errorThrown) => {
				fragment_userinfo_showMessage(jqXHR.responseText);
			});				
		}
		
		function fragment_userlist_onEdit(username) {
			$('.modal-body').empty();
			$.ajax({
			  url: '/admin/fragment_userinfo?username=' + username,
			  type: 'GET',
			  dataType: "text",
			}).done((data, textStatus, jqXHR) => {
				
				$('.modal-body').append(data);
			}).fail((jqXHR, textStatus, errorThrown) => {
				//fragment_userinfo_showMessage(jqXHR.responseText);
			});	
		}
		
		function fragment_userlist_onDelete(username) {
//debugger;
			$('#fragment_userlist_message').removeClass('alert alert-danger');
			$('.modal-body').empty();
			$.ajax({
			  url: '/api/admin/user?username=' + username,
			  type: 'DELETE',
			  dataType: "json",
			}).done((data, textStatus, jqXHR) => {
				//$('.modal-body').append(data);
				fragment_userlist_updateTable();
			}).fail((jqXHR, textStatus, errorThrown) => {
				$('#fragment_userlist_message').empty();
				$('#fragment_userlist_message').addClass('alert alert-danger');
				$('#fragment_userlist_message').append('<label>' + jqXHR.responseText + '</label>');
//				console.log(textStatus);
			});				
		}
		
		function fragment_userlist_updateTable() {
			$('#fragment_userlist_usertable').empty();
			$.ajax({
			  url: '/admin/fragment_usertable',
			  type: 'GET',
			  dataType: "text",
			}).done((data, textStatus, jqXHR) => {
				$('#fragment_userlist_usertable').append(data);
			}).fail((jqXHR, textStatus, errorThrown) => {
				console.log(textStatus);
			});	
		}
	</script>
</div>
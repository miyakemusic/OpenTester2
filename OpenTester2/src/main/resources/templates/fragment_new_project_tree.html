<div id="treeview">treeview</div>
<script type="text/javascript" th:inline="javascript">
$(function() {
	var tree = /*[[${tree}]]*/;
	;
	$('#treeview').jstree({
		"core": {                    // core config object
			"mulitple": false,         // disallow multiple selection  
			"animation": 100,          // 200ms is default value
			"check_callback" : true,   // this make contextmenu plugin to work
			"themes": {
				"variant": "medium",
				"dots": false
			},
//			"data":tree
			"data": {
				"url" : function(node) {
					var url = "/admin/project_tree_data/";
//					if (node.id === "submore") url = "/mycontext/treeview?req=sub";
					return url;
				},
				"dataType" : "json"
			},
		}
//	}).on("select_node.jstree", function(e, data){
//		debugger;
//		changeProjectMainPane(data.node.id.replace('{pt}', getPresentationType()));
		
//		console.log("selected is : id =" + data.node.id +"  "+ data.node.text);
	}).on("changed.jstree", function(e, data){
//		debugger;
//		console.log("changed is : id =" + data.node.id +"  "+ data.node.text);
		if (data.node != null) {
			changeProjectMainPane(data.node.id);
		}
	});
	
	updateTree();
	
	addTreeListener(function(url) {
//		$('#treeview').jstree().deselect_all(true);
//		$('#treeview').jstree().select_node(url);

		var selected = $('#treeview').jstree('get_selected', false);
		$('#treeview').jstree('deselect_node', selected, true);
		$('#treeview').jstree('select_node', url, true);
	});
	
});
function updateTree() {
	/*
	$.ajax({
		url: "/admin/project_tree_data/",
		type: 'GET',
		dataType: "json", 
	}).done((data, textStatus, jqXHR) => {
		$("#treeview").jstree(true).refresh();
	}).fail((jqXHR, textStatus, errorThrown) => {

	});	
	*/
	$("#treeview").jstree(true).refresh();
}
</script>
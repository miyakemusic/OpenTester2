<div th:object="${inst}">
	<input type="text" id="fragment_instrument_info_id" th:field="*{id}" hidden>
	
	<div class="m-2">
		<label for="categoryid" th:text="#{label.inst.category}">Category</label>
	    <select id="categoryid" class="instcategory form-select" th:onchange="onCategorySelect(this.value)">
	        <option th:each="category : ${categorylist}" th:value="${category.id}" th:inline="text">[[${category.name}]]</option>
	    </select>
	</div>
	
	<span class="insttypeCheck form-inline border border-secondar m-1" th:each="insttype : ${typelist}" th:classappend="'CATEGORY' + ${insttype.category.id}">
		<input th:id="${insttype.id}" class="form-check-input instTypeCheckBox" type="checkbox" 
        		th:value="${insttype.id}" th:text="${insttype.name}" th:onchange="onCheck(this.id, this.checked)" />
    	</span>
    </span>
    	
	<div class="m-2">
		<label for="venderid" th:text="#{label.inst.vendor}">Vendor</label>
	    <select id="venderid" name="venderid" class="form-select">
	        <option th:each="vendor : ${vendorlist}" th:value="${vendor.id}" th:inline="text">[[${vendor.name}]]</option>
	    </select>
	</div>

	<div class="m-2">
		<label for="fragment_instrument_info_product_family" th:text="#{label.inst.product_family}">Product Family</label>
		<input type="text" id="fragment_instrument_info_product_family" class="form-control" th:field="*{productFamily}" />
	</div>	
	<div class="m-2">
		<label for="fragment_instrument_info_model_name" th:text="#{label.inst.model_name}">Model Name</label>
		<input type="text" id="fragment_instrument_info_model_name" class="form-control" th:field="*{modelName}" />
	</div>
	<div class="m-2">
		<label for="fragment_instrument_info_description" th:text="#{label.inst.description}">Description</label>
		<input type="text" id="fragment_instrument_info_description" class="form-control" th:field="*{description}" />
	</div>
	<div class="m-2">
		<label for="fragment_instrument_info_url" th:text="#{label.inst.url}">URL</label>
		<input type="text" id="fragment_instrument_info_url" class="form-control" th:field="*{url}" />
	</div>
	<div id="fragment_vendor_info_message"></div>
</div>
<script type="text/javascript" th:inline="javascript">
	var checkedList = new Map();
	function onCheck(id, value) {
		checkedList.set(id, value);
	}
	function onCategorySelect(option) {
		$('.insttypeCheck').css('display', 'none');
		$('.CATEGORY' + option).show();
	}
	
	function fragment_instrument_info_init() {
		$('#venderid').val(0);
		$('#fragment_instrument_info_id').val("");
		$('#fragment_instrument_info_model_name').val("");
		$('#fragment_instrument_info_product_family').val("");
		$('#fragment_instrument_info_description').val("");
		$('#fragment_instrument_info_url').val("");	
		$('.instTypeCheckBox').prop('checked', false);
		checkedList.clear();
	}
	
	function fragment_instrument_info_object() {	
		var object = new Object();
		object.instrumentVendor = new Object();
		object.id = $('#fragment_instrument_info_id').val();
		object.instrumentVendor.id = $('#venderid').val();
//		object.instrumentVendorId = $('#venderid').val();
		object.modelName = $('#fragment_instrument_info_model_name').val();
		object.productFamily = $('#fragment_instrument_info_product_family').val();
		object.description = $('#fragment_instrument_info_description').val();
		object.url = $('#fragment_instrument_info_url').val();
		
		object.type = new Array();
		for (const [key, value] of checkedList) {
		  if (value) {
			  var typeObj = new Object();
			  typeObj.id = key;
			  object.type.push(typeObj);
//			  object.type.push(key);
			 
		  }
		}
		
		return object;	
	}
	
	function fragment_instrument_info_set_object(obj) {
		$('#venderid').val(obj.instrumentVendor.id);
		$('#fragment_instrument_info_id').val(obj.id);
		$('#fragment_instrument_info_model_name').val(obj.modelName);
		$('#fragment_instrument_info_product_family').val(obj.productFamily);
		$('#fragment_instrument_info_description').val(obj.description);
		$('#fragment_instrument_info_url').val(obj.url);
		$('.instTypeCheckBox').prop('checked', false);
		
		checkedList.clear();
		for (const t of obj.type) {
			checkedList.set(t.id, true);
			$('#' + t.id).prop('checked', true);
		}		
	}
</script>
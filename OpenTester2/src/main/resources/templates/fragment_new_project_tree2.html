<div id="treeview">treeview</div>
<script type="text/javascript" th:inline="javascript">
$(function() {
	var tree = /*[[${tree}]]*/;
	$('#treeview').jstree({
		"core": {                    // core config object
			"mulitple": false,         // disallow multiple selection  
			"animation": 100,          // 200ms is default value
			"check_callback" : true,   // this make contextmenu plugin to work
			"themes": {
				"variant": "medium",
				"dots": false
			},
			"data": {
				"url" : function(node) {
					var url = /*[[${url}]]*/;
					return url;
				},
				"dataType" : "json"
			},
		}
	}).on("select_node.jstree", function(e, data){
	}).on("changed.jstree", function(e, data){
		debugger;
		if (data.node != null) {
			var type = data.node.id.split('_')[0];
			var id = data.node.id.split('_')[1];
			projectMain.nodeChanged(type, id);
		}
	});
	
	updateTree();
	
	projectMain.nodeSelectionListener(function(type, id) {
		var selected = $('#treeview').jstree('get_selected', false);
		$('#treeview').jstree('deselect_node', selected, true);
		$('#treeview').jstree('select_node', type + '_' + id, true);
	});
	
	projectMain.treeStructureListener(function() {
		updateTree();
	});
});
function updateTree() {
	$("#treeview").jstree(true).refresh();
}
</script>
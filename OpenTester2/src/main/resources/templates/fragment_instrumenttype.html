<div th:insert="~{fragment_inst_header}"></div>
<div class="m-2 row g-3 align-items-center">
	<div class="col-auto"><label for="fragment_instrumenttype_category" th:text="#{label.inst.category}">Category</label></div>
	<div class="col-auto"><input type="text" id="fragment_instrumenttype_category" class="form-control" /></div>
	<div class="col-auto"><button class="btn btn-secondary" th:text="#{button.dialog.add}" th:onclick="fragment_instrumenttype_onAddCategory()"></button></div>
</div>	

<table class="table table-striped">
	<thead>
    	<tr>
			<th th:text="#{label.inst.category}">Category</th>
			<th></th>
		</tr>
	</thead>
	<tbody>
		<tr th:each="category : ${categories}">
			<td th:text="${category.name}"></td>
			<td>
				<button class="btn btn-secondary edit" data-bs-toggle="modal" th:onclick="|fragment_instrumenttype_category_edit('__${category.id}__')|" th:text="#{button.table.edit}">Edit</button>
				<button class="btn btn-secondary del" th:onclick="|fragment_instrumenttype_category_delete('__${category.id}__')|" th:text="#{button.table.delete}">Delete</button>
			</td>
		</tr>
	</tbody>
</table>

<div class="m-2 row g-3 align-items-center">
	<div class="col-auto">
		<label for="fragment_instrumenttype_category_select" th:text="#{label.inst.category}">Category</label>
	</div>
	<div class="col-auto">
		
	    <select id="fragment_instrumenttype_category_select" name="fragment_instrumenttype_category_select" class="form-select">
	        <option th:each="category : ${categories}" th:value="${category.id}" th:inline="text">[[${category.name}]]</option>
	    </select>
	</div>
	<div class="col-auto"><label for="fragment_instrumenttype_type" th:text="#{label.inst.type}">Type</label></div>
	<div class="col-auto"><input type="text" id="fragment_instrumenttype_type" class="form-control" /></div>
	
	<div class="col-auto"><label for="fragment_instrumenttype_fullname" th:text="#{label.inst.type_fullname}">Fullname</label></div>
	<div class="col-auto"><input type="text" id="fragment_instrumenttype_fullname" class="form-control" /></div>
	<div class="col-auto"><button class="btn btn-secondary" th:text="#{button.dialog.add}" th:onclick="fragment_instrumenttype_onAddType()"></button></div>
</div>	

<table class="table table-striped">
	<thead>
    	<tr>
			<th th:text="#{label.inst.category}">Category</th>
			<th th:text="#{label.inst.type}">Type</th>
			<th th:text="#{label.inst.type_fullname}">Fullname</th>
			<th></th>
		</tr>
	</thead>
	<tbody>
		<tr th:each="type : ${typelist}">
			<td th:text="${type.category.name}"></td>
			<td th:text="${type.name}"></td>
			<td th:text="${type.fullname}"></td>
			<td>
				<button class="btn btn-secondary edit" th:onclick="|fragment_instrumenttype_type_edit('__${type.id}__')|" th:text="#{button.table.edit}">Edit</button>
				<button class="btn btn-secondary del" th:onclick="|fragment_instrumenttype_type_delete('__${type.id}__')|" th:text="#{button.table.delete}">Delete</button>
			</td>
		</tr>
	</tbody>
</table>

<script type="text/javascript" th:inline="javascript">
	function fragment_instrumenttype_category_edit(id) {
		
	}
	
	function fragment_instrumenttype_category_delete(id) {
		
	}
	
	function fragment_instrumenttype_type_edit(i) {

		$('#fragment_dialog_staticBackdrop').modal('show');
	}
	
	function fragment_instrumenttype_type_delete(id) {
		$.ajax({
		  url: '/api/inst/instrumentType/' + id,
		  type: 'DELETE',
		  contentType: 'application/json',
		  dataType: "text", 
		  data: JSON.stringify(fragment_instrumenttype_type()),
		}).done((data, textStatus, jqXHR) => {
		}).fail((jqXHR, textStatus, errorThrown) => {
		});			
	}
	
	function fragment_instrumenttype_category() {
		var obj = new Object();
		obj.name = $('#fragment_instrumenttype_category').val();
		return obj;
	}
	
	function fragment_instrumenttype_type() {
		var obj = new Object();
		obj.name = $('#fragment_instrumenttype_type').val();
		obj.fullname = $('#fragment_instrumenttype_fullname').val();
		obj.category = new Object();
		obj.category.id = $('#fragment_instrumenttype_category_select').val();
		return obj;
	}
	
	function fragment_instrumenttype_onAddCategory() {
		$.ajax({
		  url: '/inst/api/instrumentCategory',
		  type: 'POST',
		  contentType: 'application/json',
		  dataType: "text", 
		  data: JSON.stringify(fragment_instrumenttype_category()),
		}).done((data, textStatus, jqXHR) => {

		}).fail((jqXHR, textStatus, errorThrown) => {
		    
		});			
	}
	
	function fragment_instrumenttype_onAddType() {
		$.ajax({
		  url: '/api/inst/admin/instrumentType',
		  type: 'POST',
		  contentType: 'application/json',
		  dataType: "text", 
		  data: JSON.stringify(fragment_instrumenttype_type()),
		}).done((data, textStatus, jqXHR) => {

		}).fail((jqXHR, textStatus, errorThrown) => {
		    
		});				
	}
</script>
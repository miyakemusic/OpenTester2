<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
	<link rel="stylesheet" th:href="@{/webjars/bootstrap/css/bootstrap.min.css}">
	<link rel="stylesheet" type="text/css" th:href="@{/css/opentester.css}" />
	
	<script th:src="@{/webjars/jquery/jquery.min.js}"></script>
	<script th:src="@{/webjars/bootstrap/js/bootstrap.min.js}"></script>
	<script th:src="@{/js/auth.js}"></script> 
    <title>User Registration</title>
</head>
<body style="padding-top:5rem">   
	<div th:insert="~{fragment_header}" ></div>
	<div class="container-fluid">
		<div class="row">
			<div id="index_maindiv" class="col-2">
			</div>
			<div id="index_rightdiv" class="col-8">	
				<div id="userregistration_messages"></div>
				<div th:insert="~{fragment_userinfo}"></div>	
				<button th:id="submit" class="btn btn-primary" th:onclick="|submitUser('__${url}__');|" th:text="#{button.dialog.submit}">Submit</button> 
			</div>
			<div id="index_maindiv" class="col-2">
			</div>
		</div>
	</div>

	<script type="text/javascript" th:inline="javascript">
		function submitUser(url) {
			$('#userregistration_messages').removeClass('alert alert-danger');
			$('#userregistration_messages').empty();
			
			var user = fragment_userinfo_object();
			$.ajax({
				url: url,
				type: 'POST',
				contentType: 'application/json',
				dataType: "text", 
				data: JSON.stringify(user),
			}).done((data, textStatus, jqXHR) => {
				window.location = '/';
			}).fail((jqXHR, textStatus, errorThrown) => {
				console.log(textStatus);
				fragment_userinfo_showMessage(jqXHR.responseText);
			});	
		}		
	</script>
</body>
</html>
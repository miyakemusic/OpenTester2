<div>
	<button onclick="fragment_newuser_onClick();" class="btn btn-secondary" th:text="#{label.user.newuser}"></button>
	<!-- Modal -->
	<div class="modal" id="fragment_newuser_staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="fragment_newuser_staticBackdropLabel" aria-hidden="true">
	  <div class="modal-dialog">
	    <div class="modal-content">
	      <div class="modal-header">
	        <h5 class="modal-title" id="fragment_newuser_staticBackdropLabel" th:text="#{title.form.userinfo}">Modal title</h5>
	        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
	      </div>
	      <div class="modal-body">
			  <!--<div th:insert="~{fragment_userinfo}"></div> -->
			  <div id="fragment_newuser_dialogbody"></div>
	      </div>
	      <div class="modal-footer">
	        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" th:text="#{button.dialog.cancel}">Cancel</button>
	        <button type="button" class="btn btn-primary" 
	        	th:onclick="fragment_newuser_onOk();" th:text="#{button.dialog.ok}">OK</button>
	      </div>
	    </div>
	  </div>
	</div>
</div>
<script type="text/javascript" th:inline="javascript">	
	$(function() {
		
	});
	
	function getNewUserInfo() {
		$.ajax({
		  url: '/admin/fragment_newuserinfo',
		  type: 'GET',
		  dataType: "text",
		}).done((data, textStatus, jqXHR) => {
			$('#fragment_newuser_dialogbody').empty();
			$('#fragment_newuser_dialogbody').append(data);
			fragment_userinfo_initvalues();
		}).fail((jqXHR, textStatus, errorThrown) => {
			//fragment_userinfo_showMessage(jqXHR.responseText);
		});			
	}
	
	function fragment_newuser_onClick() {
//		fragment_userinfo_initvalues();
		getNewUserInfo();
		
		$('#fragment_newuser_staticBackdrop').modal('show');
	}

	function fragment_newuser_onOk() {
		var user = fragment_userinfo_object();
		$.ajax({
			url: '/api/admin/newuser',
			type: 'POST',
			data: JSON.stringify(user),
			contentType: 'application/json',
			dataType: 'json'
		}).done((data, textStatus, jqXHR) => {
	//		debugger;
	//		if (auth != null) {
	//			auth.changeState('userListChanged');
	//		}
			$('#fragment_newuser_staticBackdrop').modal('hide');
			
			if (fragment_newuser_onClose != null) {
				fragment_newuser_onClose();
			}
			//$('#fragment_newuser_staticBackdrop').hide();
		}).fail((jqXHR, textStatus, errorThrown) => {
			fragment_userinfo_showMessage(jqXHR.responseText);
			console.log(textStatus);
		});				
	}
</script>
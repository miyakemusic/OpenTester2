<div th:insert="~{fragment_inst_header}"></div>
<table class="table table-striped">
	<thead>
    	<tr>
			<th th:text="#{label.inst.type}">Type</th>
			<th th:text="#{label.inst.vendor}">Vendor</th>
			<th th:text="#{label.inst.product_family}">Product Family</th>
			<th th:text="#{label.inst.model_name}">Model Name</th>
			<th th:text="#{label.inst.description}">Description</th>
			<th th:text="#{label.inst.url}">Link</th>
			<th></th>
		</tr>
	</thead>
	<tbody>
		<tr th:each="inst : ${instlist}">
			<td>
				<span class="form-check" th:each="insttype : ${inst.type}">
		        	<span th:text="${insttype.name}"></span>
			    </span>			
			</td>
			<td th:text="${inst.instrumentVendor.name}"></td>
			<td th:text="${inst.productFamily}"></td>
			<td th:text="${inst.modelName}"></td>
			<td th:text="${inst.description}"></td> 
			<td><a th:href="@{${inst.url}}" th:text="#{label.inst.url}" /></td> 
			<td>
				<button class="btn btn-secondary edit" data-bs-toggle="modal" th:onclick="|fragment_instrument_edit('__${inst.id}__')|" th:text="#{button.table.edit}">Edit</button>
				<button class="btn btn-secondary copy" data-bs-toggle="modal" th:onclick="|fragment_instrument_copy('__${inst.id}__')|" th:text="#{button.table.copy}">Copy</button>
				<button class="btn btn-secondary del" th:onclick="|fragment_instrument_delete('__${inst.id}__')|" th:text="#{button.table.delete}">Delete</button>
			</td>
		</tr>
	</tbody>
</table>
<button th:text="#{button.dialog.add}" onclick="fragment_instrument_add();" class="btn btn-primary"></button>
<script type="text/javascript" th:inline="javascript">
	function fragment_instrument_add() {
		fragment_instrument_info_init();
		$('#fragment_dialog_staticBackdrop').modal('show');
	}
		
	function fragment_dialog_onOk() {
		$.ajax({
		  url: '/api/inst/admin/instrument',
		  type: 'POST',
		  contentType: 'application/json',
		  dataType: "text", 
		  data: JSON.stringify(fragment_instrument_info_object()),
		}).done((data, textStatus, jqXHR) => {
			$('#fragment_dialog_staticBackdrop').modal('hide');
		}).fail((jqXHR, textStatus, errorThrown) => {
		    
		});				
	}
	
	function fragment_instrument_copy(id) {
		$.ajax({
		  url: '/api/instrument/' + id,
		  type: 'GET',
		  dataType: "json", 
		}).done((data, textStatus, jqXHR) => {
			data.id = "";
			fragment_instrument_info_set_object(data);
			$('#fragment_dialog_staticBackdrop').modal('show');
		}).fail((jqXHR, textStatus, errorThrown) => {
		    
		});			
	}
	
	function fragment_instrument_edit(id) {
		$.ajax({
		  url: '/api/instrument/' + id,
		  type: 'GET',
		  dataType: "json", 
		}).done((data, textStatus, jqXHR) => {
			fragment_instrument_info_set_object(data);
			$('#fragment_dialog_staticBackdrop').modal('show');
		}).fail((jqXHR, textStatus, errorThrown) => {
		    console.log(textStatus);
		});			
	}
		
	function fragment_instrument_delete(id) {
		$.ajax({
		  url: '/api/admin/instrument/' + id,
		  type: 'DELETE',
		  dataType: "json", 
		}).done((data, textStatus, jqXHR) => {

		}).fail((jqXHR, textStatus, errorThrown) => {
		    
		});				
	}
</script>
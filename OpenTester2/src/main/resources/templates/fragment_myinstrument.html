<div th:insert="~{fragment_inst_header}"></div>
<table class="table table-striped">
	<thead>
    	<tr>
			<th th:text="#{label.inst.serial_number}">Serial Number</th>
			<th th:text="#{label.inst.myinstrument}">Vendor</th>
			<th th:text="#{label.inst.location}">Location</th>
			<th th:text="#{label.inst.user}">User</th>
			<th th:text="#{label.inst.status}">Status</th>
			<th></th>
		</tr>
	</thead>
	<tbody>
		<tr th:each="myinst : ${myinstlist}">
			<td th:text="${myinst.serialNumber}"></td>
			<td th:text="${myinst.instrument.instrumentVendor.name + ' ' + myinst.instrument.productFamily + ' ' + myinst.instrument.modelName}"></td>
			<td th:text="${myinst.location}"></td>
			<td th:text="${myinst.user!=null} ? myinst.user.username : '-'"></td>
			<td th:text="${myinst.status}"></td>
			<td>
				<button class="btn btn-secondary edit" data-bs-toggle="modal" th:onclick="|fragment_myinstrument_edit('__${myinst.id}__')|" th:text="#{button.table.edit}">Edit</button>
				<button class="btn btn-secondary del" th:onclick="|fragment_myinstrument_delete('__${myinst.id}__')|" th:text="#{button.table.delete}">Delete</button>
			</td>
		</tr>
	</tbody>
</table>
<button th:text="#{button.dialog.add}" onclick="fragment_myinstrument_onAdd();" class="btn btn-primary"></button>
<button th:onclick="fragment_myinstrument_test();">Test</button>
<script type="text/javascript" th:inline="javascript">	
	function fragment_dialog_onOk() {
		$.ajax({
		  url: '/api/inst/admin/myinstrument',
		  type: 'POST',
		  contentType: 'application/json',
		  dataType: "text", 
		  data: JSON.stringify(fragment_myinstrument_info_object()),
		}).done((data, textStatus, jqXHR) => {
			$('#fragment_dialog_staticBackdrop').modal('hide');
		}).fail((jqXHR, textStatus, errorThrown) => {
		    
		});						
	}
	function fragment_myinstrument_onAdd() {
		fragment_myinstrument_info_init();
		$('#fragment_dialog_staticBackdrop').modal('show');
	}
	
	function fragment_myinstrument_edit(id) {
		$.ajax({
		  url: '/api/inst/myinstrument/' + id,
		  type: 'GET',
		  dataType: "json", 
		}).done((data, textStatus, jqXHR) => {
			fragment_myinstrument_info_set_object(data);
			$('#fragment_dialog_staticBackdrop').modal('show');
		}).fail((jqXHR, textStatus, errorThrown) => {
		    console.log(textStatus);
		});	
	}
	
	function fragment_myinstrument_delete(id) {
		
	}
	function fragment_myinstrument_test() {

		$.ajax({
		  url: '/api/admin/insttest',
		  type: 'GET',
		  dataType: "text",
		}).done((data, textStatus, jqXHR) => {
			//$('#fragment_userlist_usertable').append(data);
		}).fail((jqXHR, textStatus, errorThrown) => {
			console.log(textStatus);
		});			
	}
</script>
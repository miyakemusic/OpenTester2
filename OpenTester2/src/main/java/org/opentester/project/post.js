<script type="text/javascript" inline="javascript">
	$(function() { 
		largeDialog.callback(function() {
			largeDialog.hideDialog();
			debugger;
			var obj = new Object();
			/*[[${fillobj}]]*/
			$.ajax({
				url: '/*[[${url}]]*/',
				type: 'POST',
				data: JSON.stringify(obj),
				contentType: 'application/json',
				dataType: 'text'
			}).done((data, textStatus, jqXHR) => {
				debugger;
				updateProjectUI();
			}).fail((jqXHR, textStatus, errorThrown) => {
			});
		});
		$('.fl-ympicker').flatpickr({
			enableTime: true,
			dateFormat: "Y-m-d H:i",
		});
	
	});

	function editValueSelect(listUrl, itemid, key) {
		$('#dialogSelect').empty();
		
		var url = listUrl;
//		if (key != null) {
//			url += "?current=" + key;
//		}
//debugger;		
		$.ajax({
			url: url,
			type: 'GET',
			dataType: 'html',
		}).done((data, textStatus, jqXHR) => {
			smallDialog.callback(function() {
				smallDialog.hideDialog();
				
				var newKey = $('#dialogSelect').val();
				var newValue = $('#dialogSelect option:selected').text();
				$('#' + itemid).val(newKey);
				$('#' + itemid).text(newValue);
			});
			smallDialog.showDialog(data);
			$('#dialogSelect').val(key);
		}).fail((jqXHR, textStatus, errorThrown) => {
		});
	}
	
	function editValueCheckBox(listUrl, itemid, selected) {
		$.ajax({
			url: listUrl,
			type: 'GET',
			dataType: 'html',
		}).done((data, textStatus, jqXHR) => {
			smallDialog.callback(function() {
				smallDialog.hideDialog();
				
				var text = "";
				var ids = "";
				for (var cb of $('#checkboxes').find('input')) {
					if (cb.checked) {
						var id = cb.id;
						var label = $('label[for="' + id + '"]').text();
						text += label + "<br>";
						ids += id + ",";
					}
//					debugger;
				}
				ids = ids.substr(0, ids.length-1);
				$('#' + itemid).html(text);
				$('#' + itemid).val(ids);
			});
			smallDialog.showDialog(data);
			
			for (var id of selected) {
				$('#' + id).prop('checked', true);
			}
		}).fail((jqXHR, textStatus, errorThrown) => {
		});
	}			
</script>

	
	

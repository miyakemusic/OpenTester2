package org.opentester.project.entityresource.trash;

import org.opentester.project.ProjectConfig;
import org.opentester.project.dto.KeyValueDto;
import org.opentester.project.dto.TestItemDto;
import org.opentester.project.entity.TestItemEntity;
import org.opentester.project.entity.TestPointEntity;
import org.opentester.project.entity.mapper.DtoMapper;
import org.opentester.project.entity.mapper.TestItemMapper;
import org.opentester.project.entityresource.AbstractEntityResource;
import org.opentester.project.repository.TestItemRepository;
import org.opentester.project.repository.TestPointRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.data.jpa.repository.JpaRepository;

public class TestItemEntityResource extends AbstractEntityResource<TestItemEntity, TestItemDto, TestPointEntity> {

	@Autowired
	private TestItemRepository repository;
	
	@Autowired
	private TestItemMapper projectTestItemMapper;
	
	@Autowired
	private TestPointRepository parentRepository;

	@Override
	protected DtoMapper<TestItemEntity, TestItemDto> getMapper() {
		return projectTestItemMapper;
	}

	@Override
	public String getType() {
		return ProjectConfig.testItem;
	}

	@Override
	protected void setParent(TestItemDto dto, TestPointEntity parentEntity) {
		dto.setTestPoint(KeyValueDto.builder().key(parentEntity.getId()).value(parentEntity.toString()).build());
	}

	@Override
	protected TestItemDto getDefaultDto() {
		return TestItemDto.builder().build();
	}

	@Override
	protected JpaRepository<TestItemEntity, Long> getRepository() {
		return repository;
	}

	@Override
	protected JpaRepository<TestPointEntity, Long> getParentRepository() {
		return this.parentRepository;
	}

}

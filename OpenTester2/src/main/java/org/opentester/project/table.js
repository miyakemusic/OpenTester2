<script type="text/javascript" inline="javascript">
$(function() {
	var list = /*[[${list}]]*/;
	for (var i = 0; i < list.length; i++) {
		var p = list[i];
		new ProgressBar(p.id, p.passed, p.failed, p.untouched);
	}
	
$("#submit_btn").click(function () {
  //formセレクタを取得
  let form = $('#account_form').get(0);
  //FormData オブジェクトを作成
  let formData = new FormData( form );

  //ajax実行
  $.ajax({
    url : "/admin/upload",
    dataType: "html",
    type : "post",
    data : formData,  // dataに FormDataを指定
    processData: false,  //ajaxがdataを整形しない指定
    contentType: false  //contentTypeもfalseに指定
  }).done(function(resData) {
    //成功時の処理
  }).fail(function(resData) {
    //エラー時の処理
  });
});
});



function createNew() {
	var url = '/*[[${url}]]*/';
	var parent = /*[[${parent}]]*/;
	if (parent != null) {
		url += "?parent=" + parent;
	}
	$.ajax({
		url: url,
		type: 'GET',
		dataType: "text", 
	}).done((data, textStatus, jqXHR) => {
		largeDialog.callback(function(){
			updateProjectUI();
		});
		largeDialog.showDialog(data);
		
	}).fail((jqXHR, textStatus, errorThrown) => {

	});	
}

function on_edit_table(id) {
	var parent = /*[[${parent}]]*/;
	var url = '/*[[${url}]]*/'+ '/' + id;

	$.ajax({
		url: url, 
		type: 'GET',
		tdataType: 'html',
	}).done((data, textStatus, jqXHR) => {
		largeDialog.callback(function(){
			updateProjectUI();
		});
		largeDialog.showDialog(data);
//		updateProjectUI();
	}).fail((jqXHR, textStatus, errorThrown) => {
	});
}

function on_delete(id) {
	$.ajax({
		url: '/*[[${url}]]*/'+ '/' + id, 
		type: 'DELETE',
		tdataType: 'text',
	}).done((data, textStatus, jqXHR) => {
		updateProjectUI();
	}).fail((jqXHR, textStatus, errorThrown) => {
	});	
}

</script>
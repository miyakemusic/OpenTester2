package org.opentester.project.entity.mapper;

import org.opentester.project.dto.DutPackageDto;
import org.opentester.project.dto.KeyValueDto;
import org.opentester.project.entity.ProjectDutPackageEntity;
import org.opentester.project.entity.ProjectEntity;
import org.opentester.project.repository.ProjectRepository;
import org.springframework.beans.factory.annotation.Autowired;

public class ProjectDutPackageMapper extends DtoMapper <ProjectDutPackageEntity, DutPackageDto>{
	@Autowired
	private ProjectRepository projectRepository;
	
	@Override
	public DutPackageDto toDto(ProjectDutPackageEntity e) {
		// TODO Auto-generated method stub
		return DutPackageDto.builder()
				.id(e.getId())
				.project(isNotNull(e.getProject()) ? KeyValueDto.builder().key(e.getProject().getId()).value(e.toString()).build(): null)
				.failed(e.passFail().getFailed())
				.passed(e.passFail().getPassed())
				.untouched(e.passFail().getUntouched())
				.location(e.allLocations().toString())
				.name(e.getName())
				.operator(e.allOprerators().toString())
				.build();
	}

	@Override
	public ProjectDutPackageEntity toEntity(DutPackageDto d) {
		return ProjectDutPackageEntity.builder()
				.id(d.getId())
				.project(isNotNull(d.getProject()) ? projectRepository.findById(d.getProject().getKey()).get() : null)
				.name(d.getName())
				.build();
	}

}

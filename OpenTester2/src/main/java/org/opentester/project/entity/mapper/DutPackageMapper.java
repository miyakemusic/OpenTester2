package org.opentester.project.entity.mapper;

import org.opentester.project.dto.DutPackageDto;
import org.opentester.project.dto.KeyValueDto;
import org.opentester.project.entity.DutPackageEntity;
import org.opentester.project.entity.ProjectEntity;
import org.opentester.project.repository.ProjectRepository;
import org.springframework.beans.factory.annotation.Autowired;

public class DutPackageMapper extends DtoMapper <DutPackageEntity, DutPackageDto>{
	@Autowired
	private ProjectRepository projectRepository;
	
	@Override
	public DutPackageDto toDto(DutPackageEntity e) {
		// TODO Auto-generated method stub
		return DutPackageDto.builder()
				.id(e.getId())
				.project(isNotNull(e.getProject()) ? KeyValueDto.builder().key(e.getProject().getId()).value(e.getProject().toString()).build(): null)
				.passFail(e.passFail())
				.location(e.allLocations().toString())
				.name(e.getName())
				.operator(e.allOprerators().toString())
				.build();
	}

	@Override
	public DutPackageEntity toEntity(DutPackageDto d) {
		return DutPackageEntity.builder()
				.id(d.getId())
				.project(isNotNull(d.getProject()) ? projectRepository.findById(d.getProject().getKey()).get() : null)
				.name(d.getName())
				.build();
	}

}

package org.opentester.project.entity.mapper;

import org.opentester.project.dto.KeyValueDto;
import org.opentester.project.dto.TestProcedureDto;
import org.opentester.project.entity.TestProcedureEntity;
import org.opentester.project.repository.DutPackageRepository;
import org.opentester.project.repository.TestItemRepository;
import org.springframework.beans.factory.annotation.Autowired;

public class TestProcedureMapper extends DtoMapper<TestProcedureEntity, TestProcedureDto>{

	@Autowired
	private DutPackageRepository dutPackageRepository;
	
	@Autowired
	private TestItemRepository testItemRepository;
	
	@Override
	public TestProcedureDto toDto(TestProcedureEntity e) {
		return TestProcedureDto.builder()
				.id(e.getId())
				.dutPackage(KeyValueDto.builder().key(e.getDutPackage().getId()).value(e.getDutPackage().toString()).build())
				.testItem(KeyValueDto.builder().key(e.getTestItem().getId()).value(e.getTestItem().toString()).build())
				.build();
	}

	@Override
	public TestProcedureEntity toEntity(TestProcedureDto d) {
		return TestProcedureEntity.builder()
				.dutPackage(dutPackageRepository.findById(d.getDutPackage().getKey()).get())
				.testItem(testItemRepository.findById(d.getTestItem().getKey()).get())
				.build();
	}

}

package org.opentester.project.entity.mapper;

import org.opentester.project.dto.NodeDto;
import org.opentester.project.entity.NodeEntity;
import org.opentester.project.repository.NodeRepository;
import org.springframework.beans.factory.annotation.Autowired;

public class NodeMapper extends DtoMapper<NodeEntity, NodeDto>{

	@Autowired
	private NodeRepository nodeRepository;
	
	@Override
	public NodeDto toDto(NodeEntity e) {
		return NodeDto.builder()
				.id(e.getId())
				.name(e.getName())
				.parentId(this.isNotNull(e.getParentNode()) ? e.getParentNode().getId() : null)
				.build();
	}

	@Override
	public NodeEntity toEntity(NodeDto d) {
		NodeEntity parent = this.nodeRepository.findById(d.getParentId()).get();
		return NodeEntity.builder()
				.id(d.getId())
				.name(d.getName())
				.parentNode(parent)
				.build();
	}

}

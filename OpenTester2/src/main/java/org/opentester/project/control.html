<button class="btn btn-link" onclick="on_createNew()">New</button>
<button class="btn btn-link" onclick="on_copy()">Copy</button>
<button class="btn btn-link" onclick="on_paste()">Paste</button>
<button class="btn btn-link" onclick="on_upload()">Import</button>
<button class="btn btn-link" onclick="on_download()">Export</button>

<script type="text/javascript" inline="javascript">
$(function() {

});

function on_copy() {
	copy_node('/*[[${type}]]*/', /*[[${parent}]]*/);
}
function on_paste() {
	paste_node('/*[[${type}]]*/', /*[[${parent}]]*/);
}

function on_upload() {
	smallDialog.callback(function() {
		smallDialog.hideDialog();
		let form = $('#upload_form').get(0);
		let formData = new FormData( form );
	
		$.ajax({
			url : "/admin/upload//*[[${uploadpath}]]*/",
			dataType: "html",
			type : "post",
			data : formData,
			processData: false,
			contentType: false
		}).done(function(resData) {

		}).fail(function(resData) {
		});		
	});
	
	var div = 
		'<form id="upload_form" enctype="multipart/form-data" method="post">'+
		'<div class="file-area">' +
		'<input type="file" id="file_data" name="file_data" />' +
		'</div>' +
		'<div class="submit-area">' +
		'</div>' +
		'</form>';
		
	smallDialog.showDialog(div);
}

function on_download() {
	$.ajax({
		url : "/admin/download//*[[${uploadpath}]]*/",
		dataType: "text",
		type : "GET",
	}).done(function(resData) {
		debugger;
		var tempLink = document.createElement("a");
		var taBlob = new Blob([resData], {type: 'text/plain'});
		tempLink.setAttribute('href', URL.createObjectURL(taBlob));
		tempLink.setAttribute('download', '/*[[${uploadpath}]]*/.csv');
		tempLink.click();
		
		URL.revokeObjectURL(tempLink.href);
	}).fail(function(resData) {
	});		
}
</script>